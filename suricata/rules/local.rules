# Reglas básicas para detectar ataques comunes en el laboratorio

# Detectar SQL Injection básica (OR 1=1)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE SQL Injection (OR 1=1)"; flow:established,to_server; content:"' OR '1'='1"; http_client_body; classtype:web-application-attack; sid:1000001; rev:1;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE SQL Injection (OR 1=1)"; flow:established,to_server; content:"' OR '1'='1"; http_uri; classtype:web-application-attack; sid:1000002; rev:1;)

# Detectar XSS (Script tags)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE XSS Attack (script tag)"; flow:established,to_server; content:"<script>"; nocase; http_uri; classtype:web-application-attack; sid:1000003; rev:1;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE XSS Attack (script tag)"; flow:established,to_server; content:"<script>"; nocase; http_client_body; classtype:web-application-attack; sid:1000004; rev:1;)

# Detectar SQL Injection (UNION SELECT)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE SQL Injection (UNION SELECT)"; flow:established,to_server; content:"UNION SELECT"; nocase; http_uri; classtype:web-application-attack; sid:1000005; rev:1;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"POSSIBLE SQL Injection (UNION SELECT)"; flow:established,to_server; content:"UNION SELECT"; nocase; http_client_body; classtype:web-application-attack; sid:1000006; rev:1;)
